User: Act as an experienced prompt engineer in software development and help prepare a prompt for VS Code GitHub Copilot in the context of the current project.

The goal is to generate a clear and comprehensive prompt to VS Code GitHub Copilot asking it to create a new sub-issue under issue #44 "Epic: Extend netbox-model.yaml definition logic" for the first part ("Attributes definitions") of this issue, implement necessary code changes, and check all identified acceptance criteria (either automatically or with manual assistance).

Current context:

- Now 'netbox-model.yaml' (and corresponding logic) only supports one parameter `required` for an attribute definition.

In order to extend attributes definition capability and be ready for automatic netbox model generation from NetBox REST API, it is necessary to add the following parameters for attributes:

| parameter | example | logic | netbox-model.yaml change (entity->attribute; for testing) |
| --------- | ------- | ----- | -------------------------------------- |
| maxLength | 100 | default `100`; validation in UI input and backend: string length < maxLength  | region:name: `100` |
| type | number | default `string`; possible options so far `number`, `integer`, `boolean` (`true` or `false`); validation in UI input and backend with RegExp | rack-type:weight (new attribute): number; rack-type:desc_units (new attribute): boolean |
| pattern | ^[-a-zA-Z0-9_]+$ | RegExp used for validation in UI and backend | region:slug: `^[-a-zA-Z0-9_]+$`; site:latitude (new field): `^\d{2}.\d{6}$`; device-role:color: `^[0-9a-f]{6}$`|
| value | [ 10, 19, 21, 23 ] | enum of values; a drop-down list on UI + validation in backend | rack-type:width: [ 10, 19, 21, 23 ]; site:status: [planned, staging, active, decommissioning, retired] |
| label | [ 10 inches, 19 inches, 21 inches, 23 inches ] | enum of UI labels for the corresponding `value` enum; labels for UI drop-down | rack-type:width: [ 10 inches, 19 inches, 21 inches, 23 inches ]; site:status: [Planned, Staging, Active, Decommissioning, Retired] |
| nullable | true | default `false`; if `true` then accept empty values | site:latitude (new field): true |
| maximum | 90 | assuming field is number of integer; validation in UI input and backend: value <= maximum | site:latitude (new field): 90 |
| minimum | -90 | assuming field is number of integer; validation in UI input and backend: value <= minimum | site:latitude (new field): -90 |

Copilot should do the following:

- generate a new issue (draft) for this implementation (title, description acceptance criteria).
- show this draft and get approval.
- create this issue in GitHub and add it as a sub-task to issue "Epic: Extend netbox-model.yaml definition logic" #44.
- create a new feature branch (from main) for this issue implementation.
- implement necessary code changes.
- check application health.
- implement necessary tests (both unit and Postman-based) to confirm that application works as expected.

Important points:

- existing docker-compose should be used to launch the application for testing
- acceptance criteria should be presented as checkpoints

Please generate a corresponding prompt in Markdown format (do not use Fenced Code Blocks with three backticks).

GitHub Copilot: I’ll quickly scan the repo for where `netbox-model.yaml` is parsed/validated (backend + frontend) so the prompt can point Copilot at the right files and tests, then I’ll produce a single Markdown prompt (no fenced code blocks) with clear steps + acceptance-criteria checkpoints.

Searched for regex `netbox-model\.yaml|netbox model|NetBox model` (`**/services/backend/src/**`), 12 results

Searched for regex `netbox-model\.yaml|netboxModel|netbox model` (`**/services/frontend/**`), 1 result

Searched for regex `required:|attributes:` (`**/services/backend/config/netbox-model.yaml`), 50 results

Searched for regex `mermaid-styles\.yaml|netbox-to-mermaid\.yaml|netbox-model\.yaml` (`**/services/backend/src/**`), 7 results

Found the backend entrypoints for loading/analyzing netbox-model.yaml plus where attributes are validated/used; next I’ll read the key backend config/validation code and the existing tests so the prompt can tell Copilot exactly what to change and how to verify it.

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/services/backend/src/netbox-config/netbox-config.service.ts)

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/services/backend/src/netbox-config/netbox-model-analysis.ts)

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/services/backend/src/diagrams/commands/dto/diagram-command.dto.ts)

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/services/backend/test/netbox-model-analysis.test.ts)

Searched for regex `attributes\s*:\s*\{\}|attributes\)|validate.*attributes|required` (`**/services/backend/src/**`), 35 results

Searched for regex `netbox.*attributes|attributes.*netbox|validate.*attributes|required` (`**/services/frontend/app/**`), 19 results

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/services/backend/src/netbox-config/netbox-config.models.ts)

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/services/backend/src/diagrams/commands/diagrams-commands.service.ts#1-1), lines 1 to 260

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/services/backend/src/diagrams/commands/diagrams-commands.service.ts#260-260), lines 260 to 424

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/services/frontend/app/editor-client.tsx#1-1), lines 1 to 260

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/services/frontend/app/editor-client.tsx#260-260), lines 260 to 620

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/services/frontend/app/editor-client.tsx#620-620), lines 620 to 980

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/docs/agents/WORKFLOW.md)

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/docs/agents/TESTING.md)

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/services/backend/README.md)

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/services/frontend/README.md)

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/services/backend/config/netbox-model.yaml#1-1), lines 1 to 140

Searched for regex `^\s{2}rack-type:|rack-type:` (`**/services/backend/config/netbox-model.yaml`), 2 results

Searched for regex `^\s{2}device-role:|device-role:` (`**/services/backend/config/netbox-model.yaml`), 2 results

Searched for regex `^\s{2}site:` (`**/services/backend/config/netbox-model.yaml`), 1 result

Searched for text `latitude` (`**/services/backend/config/netbox-model.yaml`), no results

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/services/backend/config/netbox-model.yaml#150-150), lines 150 to 230

Searched for regex `class NetboxModelService|NetboxModelService` (`**/services/backend/src/netbox-config/**`), 6 results

Read [](file:///home/<user>/Projects/demo-ai-native-sdlc/services/backend/src/netbox-config/netbox-model.service.ts)

## Prompt for VS Code GitHub Copilot (Markdown, no fenced code blocks)

You are working in repo `demo-ai-native-sdlc` (Linux). Follow NPD governance: read/obey AGENTS.md and especially WORKFLOW.md (branch naming `feat/<issue-id>-short-name`) and TESTING.md (unit + Postman/Newman expectations). Keep changes incremental and scoped; do not add extra UI pages or “nice-to-have” UX beyond what’s required.

### Goal

Create a new sub-issue under Epic #44 (“Epic: Extend netbox-model.yaml definition logic”) for the first part: **Attributes definitions**, then implement it end-to-end (backend + frontend + tests), validate acceptance criteria, and confirm application health using existing `docker compose`.

### Current system context (important)

- YAML model lives at netbox-model.yaml.
- Backend loads YAML via netbox-config.service.ts and types are in netbox-config.models.ts.
- Attribute validation currently only checks `required` inside diagrams-commands.service.ts (`validateAttributes()`).
- Frontend editor is editor-client.tsx and currently only knows `attributes` + `requiredAttributes` returned by the backend `list-types` command; it renders all fields as plain text inputs (no validation, no enums/dropdowns).
- Postman regression tests exist under postman and should be extended when API behavior changes; Newman commands are in TESTING.md.

### What to build (Attributes definitions extension)

Extend attribute definitions in netbox-model.yaml (and corresponding runtime logic) beyond `required` by adding support for these parameters:

- `maxLength` (default `100`): validate in UI input and backend that string length ≤ `maxLength`
- `type` (default `string`): supported options now: `string`, `number`, `integer`, `boolean`
  - `boolean` accepts only `true` or `false`
  - validate in UI and backend (use regex / parsing)
- `pattern` (regex string): validate in UI and backend
- `value` (enum of values): UI must render as dropdown; backend validates membership
- `label` (enum of labels corresponding to `value`): UI labels for dropdown options
- `nullable` (default `false`): if `true`, allow empty value (and skip other validations when empty)
- `maximum` (number): backend + UI enforce `value <= maximum`
- `minimum` (number): backend + UI enforce `value >= minimum`

Also update netbox-model.yaml with test-driven examples (these are required for validating the feature):

- `region.attributes.name.maxLength: 100`
- `region.attributes.slug.pattern: ^[-a-zA-Z0-9_]+$`
- Add `site.attributes.latitude` with:
  - `type: number`
  - `pattern: ^\\d{2}\\.\\d{6}$` (ensure proper YAML escaping)
  - `nullable: true`
  - `minimum: -90`
  - `maximum: 90`
- `device-role.attributes.color.pattern: ^[0-9a-f]{6}$`
- `rack-type.attributes.width.value: [10, 19, 21, 23]`
- `rack-type.attributes.width.label: [10 inches, 19 inches, 21 inches, 23 inches]`
- Add `rack-type.attributes.weight.type: number`
- Add `rack-type.attributes.desc_units.type: boolean`
- `site.attributes.status.value: [planned, staging, active, decommissioning, retired]`
- `site.attributes.status.label: [Planned, Staging, Active, Decommissioning, Retired]`

### Required workflow (must follow exactly)

1) Draft the new GitHub sub-issue (do NOT create it yet)
   - Title
   - Description (scope + non-goals)
   - Acceptance criteria as checkboxes
   - Test plan section (unit + Postman/Newman + docker compose health checks)
   - Implementation notes pointing to the key files to change
2) Show the draft issue in-chat and ask for explicit approval to proceed.
3) After approval, create the issue in GitHub and add it as a sub-task of Epic #44.
   - Prefer GitHub CLI (`gh`) if available; otherwise provide step-by-step UI instructions and keep going with the branch + code work.
4) Create a feature branch from `main` using the naming convention in WORKFLOW.md:
   - `feat/<new-issue-id>-attributes-definitions` (or similar short slug)
5) Implement backend + frontend changes and update tests.
6) Validate acceptance criteria (automatically where possible). Where not possible, provide clear manual verification steps.

### Backend implementation requirements

- Update the TypeScript model types in netbox-config.models.ts so `attributes` support the new fields.
- Add strict validation when loading config (fail fast on invalid model):
  - Unsupported `type` values
  - Invalid regex in `pattern`
  - `min/max` present but not numbers
  - `minimum > maximum`
  - `value` enum present but empty / not an array
  - `label` present without `value`, or length mismatch with `value`
- Implement runtime attribute validation for `create` and `update` commands:
  - Keep existing `required` behavior
  - Enforce `nullable` semantics (if nullable and empty → allow; otherwise validate)
  - Enforce `maxLength` for strings
  - Enforce `type` rules (`integer` must reject decimals; `boolean` only true/false; `number` must parse)
  - Enforce `pattern` (regex) after type coercion rules are applied (document your order and keep it consistent)
  - Enforce `value` membership (for enums)
  - Enforce `minimum` / `maximum` for numeric types
- Update the `list-types` command response to return enough attribute metadata so the frontend can render correct inputs and validate locally.
  - Today it returns `details[type] = { attributes: string[], requiredAttributes: string[] }`.
  - Extend this contract in a backward-compatible way if feasible, but it’s acceptable to version/adjust the frontend at the same time since both live in this repo.

### Frontend implementation requirements (Editor UI)

Only modify existing editor experience in editor-client.tsx (no new pages, no new theme primitives, no hard-coded new colors/fonts/shadows).

- Use backend-provided attribute definitions for each entity type to:
  - Render dropdowns for enum attributes (`value` + optional `label`)
  - Render a boolean selector for `type: boolean` (true/false)
  - Validate inputs on change and/or before submit:
    - `maxLength`, `pattern`, `type`, `nullable`, `minimum`, `maximum`, enum membership
  - Prevent submission when validation fails and show a clear message in the existing error UI area (reuse existing error message state; do not create new modals).
- Keep existing “slug auto-generation from name” behavior, but ensure it respects `pattern` and `maxLength` if those are defined.

### Testing requirements

Add/extend tests to cover the new attribute definition features.

Backend unit tests (preferred location under test):

- Add tests verifying:
  - Valid model config accepts the new fields
  - Invalid model config is rejected (bad regex, label mismatch, minimum > maximum, unsupported type)
  - Attribute validation rejects invalid payloads and accepts valid payloads for:
    - `maxLength`
    - `type` number/integer/boolean
    - `pattern`
    - `enum value` + `label` mapping
    - `nullable`
    - `minimum`/`maximum`
- If current validation code is stuck as a private method, refactor minimally to a testable helper (keep design simple; no unrelated refactors).

Postman regression tests:

- Update Backend_API_Tests.postman_collection.json (and environment if needed) to add requests that:
  - Create/update an entity with invalid attributes and assert HTTP 400 + helpful error message
  - Create/update with valid attributes and assert success
- Use Newman commands from TESTING.md.

Health checks with docker compose:

- Use existing `docker compose up --build` from repo root.
- Verify:
  - Backend health endpoint returns OK: `GET http://localhost:3000/health`
  - Frontend loads: `http://localhost:3001`
  - Editor can create/update entities with new attribute rules enforced.

### Acceptance criteria (must be included in the new sub-issue as checkpoints)

- [ ] netbox-model.yaml supports new attribute definition fields: `maxLength`, `type`, `pattern`, `value`, `label`, `nullable`, `minimum`, `maximum`
- [ ] Backend fails fast on invalid attribute definitions in YAML (clear error message including entity + attribute key)
- [ ] Backend validates `create` and `update` command attributes against the extended definitions (all rules above)
- [ ] `list-types` returns attribute metadata sufficient for the frontend to render correct controls and perform client-side validation
- [ ] Frontend editor enforces validation for the extended definitions and renders dropdowns for enums and boolean fields
- [ ] The example updates to netbox-model.yaml are present (region/site/rack-type/device-role examples listed above)
- [ ] Unit tests added/updated and passing (`npm test` in backend)
- [ ] Postman collection tests added/updated and passing via Newman
- [ ] App runs via `docker compose up --build` and basic manual sanity checks pass (health + editor create/update)

### Commands you should run (and report results)

- Backend unit tests:
  - `cd services/backend && npm test`
- Frontend tests (if any are impacted):
  - `cd services/frontend && npm test`
- Run stack:
  - `docker compose up --build`
- Postman/Newman:
  - `cd postman && newman run Backend_API_Tests.postman_collection.json -e Local_Docker_Compose.postman_environment.json`
  - `cd postman && newman run Frontend_Proxy_Tests.postman_collection.json -e Local_Docker_Compose.postman_environment.json`

### Deliverables in this PR/branch

- Updated backend model types + config validation + runtime attribute validation
- Updated frontend editor to render dropdowns/selectors and validate inputs
- Updated YAML examples for testing
- New/updated backend unit tests
- Updated Postman collection(s) and Newman pass confirmation
- A short “How to test” note in the PR description (or in the issue) covering docker compose + Newman

Now start with step (1): produce the draft GitHub sub-issue text (title + body) and ask for approval before creating it.